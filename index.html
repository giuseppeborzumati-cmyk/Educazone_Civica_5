import React, { useState } from 'react';
import { Brain, CloudRain, ShieldAlert, Zap, Sun, Search, Copy, CheckCircle } from 'lucide-react';

const DeBonoApp = () => {
  const [problem, setProblem] = useState('');
  const [activeHat, setActiveHat] = useState(null);
  const [copied, setCopied] = useState(false);

  const hats = [
    {
      id: 'white',
      name: 'Cappello Bianco',
      desc: 'Fatti e Informazioni',
      color: 'bg-gray-100',
      textColor: 'text-gray-800',
      borderColor: 'border-gray-300',
      icon: <Search className="w-6 h-6" />,
      promptTemplate: (topic) => `Agisci come un analista dati oggettivo. Riguardo al tema "${topic}", elenca solo i fatti verificati, le statistiche disponibili e le lacune informative. Non includere opinioni o interpretazioni. Sii neutro.`
    },
    {
      id: 'red',
      name: 'Cappello Rosso',
      desc: 'Emozioni e Intuito',
      color: 'bg-red-100',
      textColor: 'text-red-800',
      borderColor: 'border-red-300',
      icon: <Brain className="w-6 h-6" />,
      promptTemplate: (topic) => `Abbandona la logica. Riguardo a "${topic}", voglio sapere come si *sentono* le persone coinvolte. Descrivi le reazioni viscerali, le paure, le speranze e le intuizioni irrazionali che questo argomento suscita. Usa un linguaggio emotivo.`
    },
    {
      id: 'black',
      name: 'Cappello Nero',
      desc: 'Cautela e Rischi',
      color: 'bg-gray-800',
      textColor: 'text-white',
      borderColor: 'border-black',
      icon: <ShieldAlert className="w-6 h-6" />,
      promptTemplate: (topic) => `Indossa il cappello del critico severo. Analizza "${topic}" e identifica ogni possibile punto debole, rischio, pericolo o difetto logico. Perché questo potrebbe fallire? Sii spietato nella tua analisi dei rischi.`
    },
    {
      id: 'yellow',
      name: 'Cappello Giallo',
      desc: 'Ottimismo e Benefici',
      color: 'bg-yellow-100',
      textColor: 'text-yellow-800',
      borderColor: 'border-yellow-300',
      icon: <Sun className="w-6 h-6" />,
      promptTemplate: (topic) => `Sii un ottimista visionario. Guarda "${topic}" e trova valore anche dove sembra non essercene. Quali sono i benefici a lungo termine? Quali sono le opportunità nascoste? Costruisci uno scenario positivo e costruttivo.`
    },
    {
      id: 'green',
      name: 'Cappello Verde',
      desc: 'Creatività e Provocazione',
      color: 'bg-green-100',
      textColor: 'text-green-800',
      borderColor: 'border-green-300',
      icon: <Zap className="w-6 h-6" />,
      promptTemplate: (topic) => `Usa il pensiero laterale. Applica una "Provocazione" (PO) al concetto di "${topic}". Proponi 3 idee assurde, illogiche o impossibili correlate a questo, e poi usale come trampolino di lancio per trovare una soluzione innovativa mai vista prima.`
    },
    {
      id: 'blue',
      name: 'Cappello Blu',
      desc: 'Controllo e Processo',
      color: 'bg-blue-100',
      textColor: 'text-blue-800',
      borderColor: 'border-blue-300',
      icon: <CloudRain className="w-6 h-6" />,
      promptTemplate: (topic) => `Agisci come un moderatore o un manager. Organizza il pensiero riguardo a "${topic}". Definisci quali sono i prossimi passi, sintetizza le opinioni contrastanti e crea un piano d'azione strutturato.`
    }
  ];

  const handleCopy = (text) => {
    navigator.clipboard.writeText(text);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  return (
    <div className="min-h-screen bg-slate-50 font-sans p-4 md:p-8">
      <div className="max-w-4xl mx-auto">
        
        {/* Header */}
        <header className="text-center mb-10">
          <h1 className="text-4xl font-bold text-slate-800 mb-2">Il Giardiniere della Mente</h1>
          <p className="text-slate-600 text-lg">
            Generatore di Prompt Laterali basato su Edward de Bono
          </p>
        </header>

        {/* Input Section */}
        <div className="bg-white rounded-xl shadow-lg p-6 mb-8 border border-slate-200">
          <label className="block text-slate-700 font-semibold mb-2 text-lg">
            Qual è l'argomento o il problema?
          </label>
          <input
            type="text"
            value={problem}
            onChange={(e) => setProblem(e.target.value)}
            placeholder="Es: Il traffico in città, Progettare una nuova tazza, Il futuro della scuola..."
            className="w-full p-4 text-lg border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:outline-none transition-colors"
          />
        </div>

        {/* Hats Grid */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8">
          {hats.map((hat) => (
            <button
              key={hat.id}
              onClick={() => setActiveHat(hat)}
              className={`p-6 rounded-xl border-2 transition-all transform hover:-translate-y-1 hover:shadow-md flex flex-col items-center text-center group
                ${activeHat?.id === hat.id ? 'ring-4 ring-offset-2 ring-indigo-400 scale-105' : ''}
                ${hat.color} ${hat.borderColor} ${hat.textColor}
              `}
            >
              <div className="mb-3 bg-white/50 p-3 rounded-full shadow-sm group-hover:scale-110 transition-transform">
                {hat.icon}
              </div>
              <h3 className="font-bold text-xl mb-1">{hat.name}</h3>
              <p className="opacity-90 text-sm">{hat.desc}</p>
            </button>
          ))}
        </div>

        {/* Result Section */}
        {activeHat && (
          <div className="animate-fade-in-up bg-white rounded-xl shadow-xl border-2 border-indigo-100 overflow-hidden">
            <div className={`p-4 border-b ${activeHat.color} flex justify-between items-center`}>
              <h2 className={`font-bold text-xl flex items-center gap-2 ${activeHat.textColor}`}>
                {activeHat.icon} Prompt Generato: {activeHat.name}
              </h2>
            </div>
            
            <div className="p-8">
              <p className="text-slate-500 mb-4 text-sm uppercase tracking-wide font-semibold">
                Copia questo prompt e incollalo nella tua IA preferita:
              </p>
              
              <div className="bg-slate-100 p-6 rounded-lg font-mono text-slate-700 leading-relaxed mb-6 relative">
                {problem ? activeHat.promptTemplate(problem) : <span className="text-slate-400 italic">Inserisci un problema sopra per vedere il prompt...</span>}
              </div>

              <div className="flex justify-end gap-3">
                <button
                  onClick={() => setProblem('')}
                  className="px-4 py-2 text-slate-500 hover:text-slate-700 transition-colors"
                >
                  Reset
                </button>
                <button 
                  onClick={() => problem && handleCopy(activeHat.promptTemplate(problem))}
                  disabled={!problem}
                  className={`flex items-center gap-2 px-6 py-3 rounded-lg font-bold text-white transition-all
                    ${problem ? 'bg-indigo-600 hover:bg-indigo-700 shadow-lg hover:shadow-indigo-500/30' : 'bg-slate-300 cursor-not-allowed'}
                  `}
                >
                  {copied ? <CheckCircle className="w-5 h-5" /> : <Copy className="w-5 h-5" />}
                  {copied ? 'Copiato!' : 'Copia Prompt'}
                </button>
              </div>
            </div>

            <div className="bg-indigo-50 p-4 text-indigo-800 text-sm border-t border-indigo-100">
              <strong>Obiettivo Pedagogico:</strong> Questo prompt costringe l'IA a uscire dai suoi pattern statistici standard ("pensiero verticale") per adottare una specifica modalità cognitiva ("pensiero laterale").
            </div>
          </div>
        )}

      </div>
      
      <style jsx global>{`
        @keyframes fadeInUp {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up {
          animation: fadeInUp 0.5s ease-out forwards;
        }
      `}</style>
    </div>
  );
};

export default DeBonoApp;
